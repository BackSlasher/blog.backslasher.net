<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Putting your Windows to sleep - BackSlasher</title>
<meta name="description" content="">


  <meta name="author" content="Nitzan">
  
  <meta property="article:author" content="Nitzan">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="BackSlasher">
<meta property="og:title" content="Putting your Windows to sleep">
<meta property="og:url" content="https://blog.backslasher.net/putting-your-windows-to-sleep.html">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2013-08-09T00:00:00+03:00">






<link rel="canonical" href="https://blog.backslasher.net/putting-your-windows-to-sleep.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Nitzan",
      "url": "https://blog.backslasher.net/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="BackSlasher Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          BackSlasher
          <span class="site-subtitle">I fix things</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/projects/">Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/nitz.jpg" alt="Nitzan" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Nitzan</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>If this prod is rocking, don’t come a-knocking</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Israel</span>
        </li>
      

      
        
          
            <li><a href="https://backslasher.net" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Backslasher</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Putting your Windows to sleep">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2013-08-09T00:00:00+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Putting your Windows to sleep
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><img src="/assets/putting-your-windows-to-sleep/PowerZoe.jpg" alt="" /></p>

<p>Although there are many blog posts about configuring standby (“sleep”)
in Windows, each one with its own insomnia joke, I thought I’d share my
methodology .</p>
<h3 id="powercfg--energy-the-one-tool-to-sort-it-all"><code class="language-plaintext highlighter-rouge">PowerCfg -energy</code>:  The one tool to sort it all</h3>
<p>I only learnt about this command near the end of my testing, but it
still managed to save me a lot of work.<br />
Execute this command (as an administrator) when the computer is idling.
It will run for 60 seconds, profile the system and generate an HTML
report about energy-related problems.<br />
Some will be irrelevant for sleeping (e.g. “Processor utilization is high”) but some will save you
valuable time. Try reading the report before following my guide, because
you may find some instant problem solvers.</p>

<h3 id="what-is-sleep">What is Sleep</h3>
<p>Microsoft defines in this article 6 sleeping states - S0 to S5<br />
<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff564575%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/hardware/ff564575%28v=vs.85%29.aspx</a><br />
<strong>S0</strong> is a fully working computer.<br />
<strong>S1</strong>..<strong>S3</strong> are standby states, in which some parts of the computer
are turned off to conserve power but resuming to S0 is relatively quick
(2-30sec). These states differ by how many parts are shut down - in S1
only the processor clock and buses are shut down, and in S3 the entire
processor and some parts of the motherboard are shut down.<br />
<strong>S4</strong> is hibernation - the computer is shut down, but the operating
system context (memory, running services etc.) is saved to the
hibernation file. When the computer is turned on, the operating system
detects that it has been hibernated and loads its context from the
hibernation file instead of starting fresh<br />
<strong>S5</strong> is shutting the computer down completely.<br />
When people refer to sleeping, they usually refer to S3.<br />
You can see in the energy report which states are supported:</p>

<p><img src="/assets/putting-your-windows-to-sleep/PowerEnergyReport.png" alt="" /></p>

<h3 id="how-sleep-works">How Sleep Works</h3>
<p>When sleep is enabled, after the computer idles for a set time (e.g. 15
minutes), it will stop working and turn off some of its components to
save power. The user can “wake” the computer to full power in order to
resume work.</p>

<h3 id="gp-settings">GP Settings</h3>
<p>There are several ways to configure Windows’ sleep settings.<br />
Assuming you manage Windows 7+ workstations, the most convenient way is
to use the Administrative Templates found in<br />
<code class="language-plaintext highlighter-rouge">Administrative Templates &gt; System &gt; Power Management &gt; Sleep Settings</code>.</p>

<p><img src="/assets/putting-your-windows-to-sleep/PowerSleepGP.png" alt="" /></p>

<p>Some things to note:</p>

<ul>
  <li>Some interesting settings (such as “Turn off the display”) are found
in other folders inside “Power Management”.</li>
  <li>“Unattended sleep” is the computer returning to sleep after being
woken up using an automated method (like a scheduled task, magic
packet etc.), as opposed to being woken up from user interaction,
like a mouse move.</li>
  <li>Hybrid sleep is a new-ish power saving option for laptops (or other
battery-equipped computers). The computer turns off the screen
immediately while creating a hibernation file. After creating the
file, it goes to standby (instead of shutting down like normal S4).
If the computer doesn’t lose power, it will resume quickly from
standby. If it does, it will resume from the hibernation file.</li>
  <li>Disabling “Allow standby states (S1-S3) when sleeping” will prevent
the computer from sleeping. UI options for sleep will disappear (as
if the computer didn’t have that capability) and sleeping through
command line (see ahead) will cause the computer to hibernate
instead.</li>
</ul>

<h3 id="why-wont-it-sleep">Why Won’t it Sleep</h3>
<p>The reasons for computers not sleeping as expected are divided into 3
main categories:</p>

<ul>
  <li>
    <p><strong>Windows Won’t Try</strong><br />
Try putting the computer to sleep manually, like this:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  :::bat
  %windir%\System32\rundll32.exe powrprof.dll,SetSuspendState Standby   If the computer still won't sleep, check if:
</code></pre></div>    </div>

    <ul>
      <li>Sleep is unavailable on the hardware level (really old hardware, not
enabled on BIOS…)</li>
      <li>
        <p>Sleep is disabled by GP. Check the registry key:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:::registry
HKLM\Software\Policies\Microsoft\Power\PowerSettings\abfc2519-3608-4c2a-94ea-171b0ed546ab:ACSettingIndex=1
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>Windows is Busy<br />
If the computer will sleep when manually instructed but won’t sleep by
itself, it might be busy doing something that mustn’t be interrupted.<br />
For example, media players will usually ask Windows not to sleep when
they’re playing.<br />
Current requests can be viewed using <code class="language-plaintext highlighter-rouge">PowerCfg -requests</code> and they look a little like this:</p>

    <p><img src="/assets/putting-your-windows-to-sleep/PowerRequests.png" alt="" /></p>

    <p>The usual suspect list contains media players, IM software with voice
  chat, AV software and indexing software (like google desktop).</p>
  </li>
  <li>
    <p><strong>Windows Keeps Getting Bothered</strong><br />
  Windows allows different devices and software to wake it up from sleep.<br />
  For example, scheduled tasks can wake Windows up to execute:</p>

    <p><img src="/assets/putting-your-windows-to-sleep/PowerTask.jpg" alt="" /></p>

    <p>Or network cards can wake up the computer, either by any incoming
  activity or a special “magic packet”:</p>

    <p><img src="/assets/putting-your-windows-to-sleep/PowerNIC.png" alt="" /></p>

    <p>And of course, you can usually tap your keyboard to wake your computer up:</p>

    <p><img src="/assets/putting-your-windows-to-sleep/PowerKeyboard.png" alt="" /></p>

    <p>Some of those devices / features may be misbehaving and keep waking
  windows up.<br />
  You can try:</p>

    <ul>
      <li>
        <p>Using this command to see which hardware devices can wake the
  computer:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:::bat
powercfg.exe -devicequery wake_armed
</code></pre></div>        </div>
      </li>
      <li>
        <p>Using this command to see what caused the computer to wake up the
  last time:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:::bat
powercfg.exe /lastwake
</code></pre></div>        </div>
      </li>
      <li>
        <p>Disconnecting some devices and disabling some tasks to see if the
  computer suddenly goes to sleep</p>
      </li>
    </ul>
  </li>
</ul>

<p>Now go get a good night’s sleep.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#group-policy" class="page__taxonomy-item" rel="tag">Group Policy</a><span class="sep">, </span>
    
      <a href="/tags/#mysteries-solved" class="page__taxonomy-item" rel="tag">Mysteries Solved</a><span class="sep">, </span>
    
      <a href="/tags/#performance" class="page__taxonomy-item" rel="tag">Performance</a><span class="sep">, </span>
    
      <a href="/tags/#power-management" class="page__taxonomy-item" rel="tag">Power Management</a><span class="sep">, </span>
    
      <a href="/tags/#ramblings" class="page__taxonomy-item" rel="tag">Ramblings</a><span class="sep">, </span>
    
      <a href="/tags/#registry" class="page__taxonomy-item" rel="tag">Registry</a><span class="sep">, </span>
    
      <a href="/tags/#windows" class="page__taxonomy-item" rel="tag">Windows</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#microsoft" class="page__taxonomy-item" rel="tag">Microsoft</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2013-08-09T00:00:00+03:00">August 9, 2013</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/adding-net-35-to-windows-server-2012-template.html" class="pagination--pager" title="Adding .net 3.5 to a Windows Server 2012 template
">Previous</a>
    
    
      <a href="/network-monitor-capture-filter-limitations.html" class="pagination--pager" title="Network Monitor capture filter limitations
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <!-- start custom comments snippet -->
<div id="graphcomment"></div>
<script type="text/javascript">

  /* - - - CONFIGURATION VARIABLES - - - */

  // make sure the id is yours
  window.gc_params = {
    graphcomment_id: 'Backslasher-net',

    // if your website has a fixed header, indicate it's height in pixels
    fixed_header_height: 0,
  };

  /* - - - DON'T EDIT BELOW THIS LINE - - - */

  
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();

</script>
<!-- end custom comments snippet -->

  
</div>

    
  </article>

  
  
    <div class="page__related">
      <div align="center" style="margin: 1em 0;">
        <ins class="adsbygoogle"
              style="display:block; border-bottom: initial;"
              data-ad-client="ca-pub-7328585512091257"
              data-ad-slot="3049671934"
              data-ad-format="auto"
              data-full-width-responsive="true"></ins>
      </div>
      <h2 class="page__related-title">You May Also Enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/jar-patch.html" rel="permalink">Patching a Java JAR
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I’m working with a company that uses smart IoT devices produced far away.
The main troubleshooting tool is a Java utility provided by the manufacturer.
This ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/javax-mail-1.4.7.html" rel="permalink"><code class="language-plaintext highlighter-rouge">javax.mail:mail</code> 1.4.7 is broken, and how to workaround
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">javax.mail and I
One of the current tasks on my agenda involves the modernization of a project that is currently built on Java 8.
Given that this project is ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/wsl-security-analysts.html" rel="permalink">WSL for non-programming security analysts
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I have a friend who isn’t a developer and believes that coding is beyond their grasp. They work as a security analyst and prefer using Windows as their opera...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pdf-keep-or-delete.html" rel="permalink">Bash “Keep or Delete” script for PDFs
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I recently discovered that I had over 100 PDFs in my “Downloads” directory and needed to determine which ones I wanted to keep.
Instead of spending 10 minute...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

      <div align="center" style="margin: 1em 0;">
        <ins class="adsbygoogle"
             style="display:block; border-bottom: initial;"
             data-ad-client="ca-pub-7328585512091257"
             data-ad-slot="3049671934"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      </div>
    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Nitzan. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S2WYJL3VQ7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S2WYJL3VQ7', { 'anonymize_ip': true});
</script>






    <!-- start custom comments scripts -->

<!-- end custom comments scripts -->





    <style>
      .google-auto-placed {
        margin: 2em auto;
      }
    </style>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

  </body>
</html>
